<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
     <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500&display=swap" rel="stylesheet">
     <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"/>
      <link rel="stylesheet" href="/css/header.css">
      <link rel="stylesheet" href="/css/search.css">
    <title>Document</title>
    <style>
      #searchContainer {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 20px;
      }
      #searchInput {
        flex: 1;
        margin-right: 10px;
      }
      #searchButton {
        margin-right: 10px;
      }
      #resultsContainer {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
      }
      .resultCard {
        width: 200px;
        margin: 10px;
        border: 1px solid #ccc;
        padding: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
      }
       .resultCard i{
        position: absolute;
        top : 30px;
        right: 20px;
       }
      .resultCard img {
        max-width: 100%;
        margin-bottom: 10px;
      }
      .resultCard h4 {
        margin: 0;
        font-size: 1.2em;
        text-align: center;
      }
      .resultCard p {
        margin: 0;
        font-size: 0.9em;
        text-align: center;
        color: #666;
      }
    </style>
  </head>
  <body>


        <!-- header -->
       <div class="wrapper">
      <nav>
        <h3>Jojo's Food</h3>
        <ul>
          <li >
            <a href="/pages/landingpage.html" class="nav-link"><i class="fas fa-house"></i><span>Home</span></a>
          </li>
          <li>
            <a href="/pages/cart.html" class="nav-link"><i class="fa fa-microchip" aria-hidden="true"></i><span>Orders</span></a>
          </li>
          <li>
            <a href="/pages/profile.html" class="nav-link"><i class="fas fa-user"></i><span>Profile</span></a>
          </li>
          <li >
            <a href="/pages/AboutUs.html" class="nav-link" > <i class="fas fa-question-circle"></i> </i><span>About</span></a>
          </li>
          <li class="active"> 
            <a href="/pages/search.html" class="nav-link"> <i class="fas fa-search" aria-hidden="true"></i> <span>Search</span></a>
          </li>
        </ul>
      </nav>
    </div>






    <h1>Meal and Cocktail Search</h1>
    <div id="searchContainer">
      <input type="text" id="searchInput" placeholder="Search for a meal or cocktail..." />
      <label for="countryInput">Country:</label>
      <select id="countryInput" name="country"></select><br />
      <button id="searchButton" onclick="search()">Search</button>
    </div>
    <div id="resultsContainer"></div>

    <script>
      const drinksPrices = [500, 700, 1000, 1200, 1500, 1800, 2000, 2200, 2500];

      function generateRandomPrice() {
        return drinksPrices[Math.floor(Math.random() * drinksPrices.length)];
      }

      fetch("https://www.themealdb.com/api/json/v1/1/list.php?a=list")
        .then((response) => {
          if (!response.ok) {
            throw new Error("Network response was not ok");
          }
          return response.json();
        })
        .then((data) => {
          let html = "<option value=''>All</option>";
          for (let i = 0; i < data.meals.length; i++) {
            const country = data.meals[i].strArea;
            html += `<option value='${country}'>${country}</option>`;
          }
          document.getElementById("countryInput").innerHTML = html;
        })
        .catch((error) => {
          console.error("There was a problem with the fetch operation:", error);
        });

        

    //   function search() {
    //     const input = document.getElementById('searchInput').value;
    //     const country = document.getElementById('countryInput').value;
    //     let mealUrl = `https://www.themealdb.com/api/json/v1/1/filter.php?i=${input}`;
    //     if (country) {
    //       mealUrl += `&a=${country}`;
    //     }
    //     const cocktailUrl = `https://www.thecocktaildb.com/api/json/v1/1/search.php?s=${input}`;
    //     const resultsContainer = document.getElementById('resultsContainer');
    //     resultsContainer.innerHTML = ''; // clear previous search results
    //     Promise.all([
    //       fetch(mealUrl),
    //       fetch(cocktailUrl)
    //     ])
    //       .then((responses) => {
    //         // Check if responses are ok
    //         const responsePromises = responses.map((response) => {
    //           if (!response.ok) {
    //             throw new Error("Network response was not ok");
    //           }
    //           return response.json();
    //         });
    //         return Promise.all(responsePromises);
    //       })
    //       .then((data) => {
    //         const meals = data[0].meals || [];
    //         const cocktails = data[1].drinks || [];
    //         let html = '';
    //         meals.forEach((meal) => {
    //           html += `
    //             <div class="resultCard">
    //               <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
    //                <i id="cartIcon" class="fa fa-cart-plus"></i>
    //               <h4>${meal.strMeal}</h4>
    //               <p>${meal.strArea}</p>
    //               <p>Price: ${generateRandomPrice()}</p>
    //             </div>
    //           `;
    //         });
    //         cocktails.forEach((cocktail) => {
    //           html += `
    //             <div class="resultCard">
    //               <img src="${cocktail.strDrinkThumb}" alt="${cocktail.strDrink}">
    //                <i id="cartIcon" class="fa fa-cart-plus"></i>
    //               <h4>${cocktail.strDrink}</h4>
    //               <p>${cocktail.strCategory}</p>
    //               <p>Price: ${generateRandomPrice()}</p>
    //             </div>
    //           `;
    //         });
    //         resultsContainer.innerHTML = html;
    //       })
    //       .catch((error) => {
    //         console.error("There was a problem with the fetch operation:", error);
    //       });
          
    //   }


      // Add an event listener to the cart icon
//  document.getElementById("resultsContainer").addEventListener("click", function(event) {
//     if (event.target && event.target.matches("i.fa-cart-plus")) {
//       const item = event.target.parentNode.querySelector("h4").textContent;
//       const price = parseFloat(event.target.parentNode.querySelector("p:last-of-type").textContent.replace(/\$/g, ""));
//       const img = event.target.parentNode.querySelector("img").src;
//       const quantity = parseInt(prompt("How many would you like to add to your cart?", "1"));
//       if (quantity > 0) {
//         const cart = JSON.parse(localStorage.getItem("cart") || "[]");
//         const existingItem = cart.find(cartItem => cartItem.item === item);
//         if (existingItem) {
//           existingItem.quantity += quantity;
//         } else {
//          cart.push({ item, price, quantity, img });

//         }
//         localStorage.setItem("cart", JSON.stringify(cart));
//         alert(`${quantity} ${item}(s) added to your cart!`);
//       }
//     }
//   });

// --------------------------------------------------------------


function search() {
  const input = document.getElementById('searchInput').value;
  const country = document.getElementById('countryInput').value;
  let mealUrl = `https://www.themealdb.com/api/json/v1/1/filter.php?i=${input}`;
  if (country) {
    mealUrl += `&a=${country}`;
  }
  const cocktailUrl = `https://www.thecocktaildb.com/api/json/v1/1/search.php?s=${input}`;
  const resultsContainer = document.getElementById('resultsContainer');
  resultsContainer.innerHTML = ''; // clear previous search results
  Promise.all([
    fetch(mealUrl),
    fetch(cocktailUrl)
  ])
    .then((responses) => {
      // Check if responses are ok
      const responsePromises = responses.map((response) => {
        if (!response.ok) {
          throw new Error("Network response was not ok");
        }
        return response.json();
      });
      return Promise.all(responsePromises);
    })
    .then((data) => {
      const meals = data[0].meals || [];
      const cocktails = data[1].drinks || [];
      let html = '';
      meals.forEach((meal) => {
        html += `
          <div class="resultCard">
            <img src="${meal.strMealThumb}" alt="${meal.strMeal}">
            <i class="fa fa-cart-plus" data-product="${meal.idMeal}"></i>
            <h4>${meal.strMeal}</h4>
            <p>${meal.strArea}</p>
            <p>Price: ${generateRandomPrice()}</p>
          </div>
        `;
      });
      cocktails.forEach((cocktail) => {
        html += `
          <div class="resultCard">
            <img src="${cocktail.strDrinkThumb}" alt="${cocktail.strDrink}">
            <i class="fa fa-cart-plus" data-product="${cocktail.idDrink}"></i>
            <h4>${cocktail.strDrink}</h4>
            <p>${cocktail.strCategory}</p>
            <p>Price: ${generateRandomPrice()}</p>
          </div>
        `;
      });
      resultsContainer.innerHTML = html;

      // Add an event listener to the cart icon
      const cartIcons = document.querySelectorAll(".fa-cart-plus");
      cartIcons.forEach((icon) => {
        icon.addEventListener("click", function(event) {
          const productId = event.target.dataset.product;
          const productCard = event.target.closest(".resultCard");
          const productName = productCard.querySelector("h4").textContent;
          const productPrice = parseFloat(productCard.querySelector("p:last-of-type").textContent.replace(/\$/g, ""));
          const productImage = productCard.querySelector("img").src;
          const product = {
            id: productId,
            name: productName,
            price: productPrice,
            image: productImage
          };
          addToCart(product);
        });
      });
    })
    .catch((error) => {
      console.error("There was a problem with the fetch operation:", error);
    });
}

function addToCart(product) {
  const cart = JSON.parse(localStorage.getItem('cart')) || [];
  const productIndex = cart.findIndex(p => p.id === product.id);
  if (productIndex !== -1) {
    const quantity = parseInt(prompt("How many do you want to add to cart?", "1"));
    if (!isNaN(quantity)) {
      cart[productIndex].quantity += quantity;
    } else {
      alert("Invalid quantity entered");
    }
  } else {
    const quantity = parseInt(prompt("How many do you want to add to cart?", "1"));
    if (!isNaN(quantity)) {
      cart.push({...product, quantity: quantity});
    } else {
      alert("Invalid quantity entered");
    }
  }
  localStorage.setItem('cart', JSON.stringify(cart));
}



// -------------------------------------------------------------------------

// const addToCart = (item, price) => {
//   const cart = JSON.parse(localStorage.getItem('cart')) || [];
//   const productIndex = cart.findIndex(p => p.name === item.strDrink || p.name === item.strMeal);
//   if (productIndex !== -1) {
//     // If the product already exists in the cart, update its quantity and price
//     const quantity = prompt(`Enter the quantity of ${item.strDrink || item.strMeal} you want to add to cart:`);
//     cart[productIndex].quantity += Number(quantity);
//     cart[productIndex].price = price;
//     localStorage.setItem('cart', JSON.stringify(cart));
//     alert(`Added ${quantity} ${item.strDrink || item.strMeal} to cart!`);
//   } else {
//     // Otherwise, add a new product to the cart
//     const quantity = prompt(`Enter the quantity of ${item.strDrink || item.strMeal} you want to add to cart:`);
//     const product = {
//       name: item.strDrink || item.strMeal,
//       category: item.strCategory || item.strMeal,
//       type: item.strCategory || item.strMealType || "N/A",
//       price: price,
//       quantity: Number(quantity),
//       image: item.strDrinkThumb || item.strMealThumb
//     };
//     cart.push(product);
//     localStorage.setItem('cart', JSON.stringify(cart));
//     alert(`Added ${quantity} ${item.strDrink || item.strMeal} to cart!`);
//   }
//   console.log(cart);
// };

// Add an event listener to the cart icon
// document.getElementById("resultsContainer").addEventListener("click", function(event) {
//   if (event.target && event.target.matches("i.fa-cart-plus")) {
//     const item = event.target.parentNode.querySelector("h4").textContent;
//     const price = parseFloat(event.target.parentNode.querySelector("p:last-of-type").textContent.replace(/\$/g, ""));
//     const img = event.target.parentNode.querySelector("img").src;
//     const product = {
//       name: item,
//       price: price,
//       image: img
//     };
//    addToCart(product);

//   }
// });




    </script>



    <div id="notification-container"></div>


<div class="lastConatiner"></div>








<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script src="/js/single.js"></script>
<script src="/js/pop.js"></script>
<!-- <script src="/js/cart.js"></script> -->
    
  </body>
</html>
