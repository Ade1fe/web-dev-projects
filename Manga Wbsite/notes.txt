const apiKey = '02786c33c3cf2d6b3ed4996c322f3e3f';
const baseUrl = 'https://api.adzuna.com/v1';
const endpoint = `${baseUrl}/api/jobs/gb/search/1`;
const queryParams = {
  app_id: '9f5cec5c',
  app_key: apiKey,
};
const queryString = Object.keys(queryParams)
  .map((key) => `${encodeURIComponent(key)}=${encodeURIComponent(queryParams[key])}`)
  .join('&');
const url = `${endpoint}?${queryString}`;

fetch(url)
  .then((response) => response.json())
  .then((data) => {
    const jobList = data.results;
    const advertContainer = document.getElementById('advert-container');
    let currentIndex = 0;

    function changeAdvert() {
      const job = jobList[currentIndex];

      const advertPost = document.createElement('div');
      advertPost.classList.add('advert-post');

      const advertImage = document.createElement('img');
      advertImage.src = job.image;
      advertImage.alt = 'Advert Image';

      const advertDetails = document.createElement('div');
      advertDetails.classList.add('advert-details');

      const advertTitle = document.createElement('h2');
      advertTitle.classList.add('advert-title');
      advertTitle.textContent = job.title;

      const datePosted = document.createElement('span');
      datePosted.classList.add('date');
      datePosted.textContent = job.posted_on;

      const author = document.createElement('span');
      author.classList.add('author');
      author.textContent = job.author;

    const jobDescription = document.createElement('p');
jobDescription.classList.add('advert-description');
jobDescription.textContent = job.description;

if (jobDescription.textContent.length > 15) {
  jobDescription.textContent = jobDescription.textContent.slice(0, 15) + "...";
}


      const readMoreLink = document.createElement('a');
      readMoreLink.href = job.link;
      readMoreLink.classList.add('btn');
      readMoreLink.textContent = 'Read More';

      advertDetails.appendChild(advertTitle);
      advertDetails.innerHTML += 'Posted on ';
      advertDetails.appendChild(datePosted);
      advertDetails.innerHTML += ' by ';
      advertDetails.appendChild(author);
      advertDetails.appendChild(jobDescription);
      // advertDetails.appendChild(readMoreLink);

      advertPost.appendChild(advertImage);
      advertPost.appendChild(advertDetails);

      advertContainer.innerHTML = ''; // Clear existing advertisement
      advertContainer.appendChild(advertPost);

      currentIndex = (currentIndex + 1) % jobList.length; // Update current index for the next advertisement

      setTimeout(changeAdvert, 3000); // Schedule the next advertisement change after 3 seconds
    }

    setTimeout(changeAdvert, 3000); // Start the advertisement rotation after 3 seconds
  })
  .catch((error) => {
    console.error('Error occurred:', error);
  });
